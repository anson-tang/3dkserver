<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>第 16 章 广播及聊天相关协议</title><link rel="stylesheet" type="text/css" href="docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="3DK 通信协议说明文档" /><link rel="up" href="index.html" title="3DK 通信协议说明文档" /><link rel="prev" href="ch15s07.html" title="15.7. 一键领取观星奖励" /><link rel="next" href="ch16s02.html" title="16.2. 多播推送状态有更新的事件" /></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 16 章 广播及聊天相关协议</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch15s07.html">上一页</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch16s02.html">下一页</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="idp78424064"></a>第 16 章 广播及聊天相关协议</h1></div></div></div><div class="toc"><p><strong>目录</strong></p><dl class="toc"><dt><span class="section"><a href="ch16.html#idp78425008">16.1. 全服推送走马灯的同步消息</a></span></dt><dt><span class="section"><a href="ch16s02.html">16.2. 多播推送状态有更新的事件</a></span></dt><dt><span class="section"><a href="ch16s03.html">16.3. 推送有新的聊天信息的通知</a></span></dt><dt><span class="section"><a href="ch16s04.html">16.4. 玩家进入房间</a></span></dt><dt><span class="section"><a href="ch16s05.html">16.5. 玩家在房间中 获取历史聊天记录</a></span></dt><dt><span class="section"><a href="ch16s06.html">16.6. 玩家退出房间</a></span></dt><dt><span class="section"><a href="ch16s07.html">16.7. 给房间推送的世界聊天信息</a></span></dt><dt><span class="section"><a href="ch16s08.html">16.8. 实时推送的私聊信息</a></span></dt><dt><span class="section"><a href="ch16s09.html">16.9. 给房间推送的仙盟聊天信息</a></span></dt><dt><span class="section"><a href="ch16s10.html">16.10. 世界聊天</a></span></dt><dt><span class="section"><a href="ch16s11.html">16.11. 私聊</a></span></dt><dt><span class="section"><a href="ch16s12.html">16.12. 仙盟聊天</a></span></dt><dt><span class="section"><a href="ch16s13.html">16.13. 获取本地循环播放的走马灯消息</a></span></dt><dt><span class="section"><a href="ch16s14.html">16.14. 全服推送新跑马灯的同步消息</a></span></dt><dt><span class="section"><a href="ch16s15.html">16.15. 领取跑马灯奖励</a></span></dt></dl></div><p>本章定义了所有广播及聊天相关的通信协议格式。</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idp78425008"></a>16.1. 全服推送走马灯的同步消息</h2></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="1" /><col class="2" /><col class="3" /><col class="4" /><col class="5" /></colgroup><tbody><tr><td>协议名称</td><td colspan="4">全服推送走马灯的同步消息</td></tr><tr><td>呼叫方</td><td>应答方</td><td>函数名</td><td>请求参数说明</td><td>返回值格式说明</td></tr><tr><td>网关服务器</td><td>客户端</td><td>sync_broadcast</td><td><div class="informaltable"><table border="1"><colgroup><col class="1" /><col class="2" /><col class="3" /></colgroup><tbody><tr><td>参数</td><td>类型</td><td>说明</td></tr><tr><td>messages</td><td>Array(Array(msg_type, msg), ...)</td><td>本次推送的走马灯消息列表，可能多条。</td></tr><tr><td>msg_type</td><td>int</td><td>走马灯消息类型。1:GM消息，优先级最高;2：活动消息，优先级次之;3:玩家成就消息，优先级仅高于本地tips。</td></tr><tr><td>msg</td><td>String or Array</td><td>msg_type=1时, String; msg_type=2时, String; msg_type=3时, msg=Array(achieve_type, achieve_data)。</td></tr><tr><td>achieve_data</td><td>Array</td><td><div class="literallayout"><p>achieve_type=1时为神将进阶到+5以上, achieve_data=Array(nick_name, fellow_id, advanced_level); <br />
achieve_type=2时为情缘抽到紫将, achieve_data=Array(nick_name, card_type, Array(fellow_id, ...)); <br />
    注 card_type: uint, 1-凡缘,2-良缘,3-奇缘,4-奇缘十连抽。<br />
achieve_type=3时为竞技场前十名, achieve_data=Array(nick_name, rank); <br />
    注 rank: uint, 为在竞技场中的名次。<br />
achieve_type=4时为开箱子得到稀有道具, achieve_data=Array(nick_name, chest_id, Array((item_type, item_id, quantity), ...)); <br />
    注 chest_id: uint, 宝箱ID。item_id: uint, 道具ID。<br />
achieve_type=5时为翻牌得到稀有道具, achieve_data=Array(nick_name, item_type, item_id, quantity)<br />
achieve_type=6时为限时神将抽到紫将, achieve_data=Array(nick_name, fellow_id); <br />
achieve_type=7时为新年红包抽到钻石, achieve_data=Array(nick_name, credits); <br />
achieve_type=8时为情人之吻抽到豪华礼包, achieve_data=Array(nick_name, Array(item_user_id, item_type, item_id, item_num));<br />
achieve_type=9时为充值 achieve_data = Array(nick_name, lead_id, charge_id, vip_level) charge_id:充值档<br />
achieve_type=10时为vip升级 achieve_data = Array(nick_name, lead_id, vip_level) <br />
achieve_type=11时为魔主第一名 achieve_data = Array(nick_name, lead_id)<br />
achieve_type=12时为十连抽 achieve_data = Array(nick_name, lead_id)<br />
                        </p></div></td></tr></tbody></table></div></td><td> </td></tr><tr><td>协议说明</td><td colspan="4"> </td></tr></tbody></table></div></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch15s07.html">上一页</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch16s02.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">15.7. 一键领取观星奖励 </td><td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td><td width="40%" align="right" valign="top"> 16.2. 多播推送状态有更新的事件</td></tr></table></div></body></html>