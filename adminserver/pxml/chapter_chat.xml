<chapter>
    <title>广播及聊天相关协议</title>
    <para>本章定义了所有广播及聊天相关的通信协议格式。</para>

    <section>
        <title>全服推送走马灯的同步消息</title>
        <para><informaltable>
            <tgroup cols="5">
            <colspec colnum="1" colname="1" />
            <colspec colnum="2" colname="2" />
            <colspec colnum="3" colname="3" />
            <colspec colnum="4" colname="4" />
            <colspec colnum="5" colname="5" />
            <tbody>
                <row>
                    <entry>协议名称</entry><entry namest="2" nameend="5">全服推送走马灯的同步消息</entry>
                </row>
                <row>
                    <entry>呼叫方</entry>
                    <entry>应答方</entry>
                    <entry>函数名</entry>
                    <entry>请求参数说明</entry>
                    <entry>返回值格式说明</entry>
                </row>
                <row>
                    <entry>网关服务器</entry>
                    <entry>客户端</entry>
                    <entry>sync_broadcast</entry>
                    <entry><informaltable>
                    <tgroup cols="3">
                    <colspec colname="1" colnum="1"/>
                    <colspec colname="2" colnum="2"/>
                    <colspec colname="3" colnum="3"/>
                    <tbody>
                      <row>
                        <entry>参数</entry>
                        <entry>类型</entry>
                        <entry>说明</entry>
                      </row>
                      <row>
                        <entry>messages</entry>
                        <entry>Array(Array(msg_type, msg), ...)</entry>
                        <entry>本次推送的走马灯消息列表，可能多条。</entry>
                      </row>
                      <row>
                        <entry>msg_type</entry>
                        <entry>int</entry>
                        <entry>走马灯消息类型。1:GM消息，优先级最高;2：活动消息，优先级次之;3:玩家成就消息，优先级仅高于本地tips。</entry>
                      </row>
                      <row>
                        <entry>msg</entry>
                        <entry>String or Array</entry>
                        <entry>msg_type=1时, String; msg_type=2时, String; msg_type=3时, msg=Array(achieve_type, achieve_data)。</entry>
                      </row>
                      <row>
                        <entry>achieve_data</entry>
                        <entry>Array</entry>
                        <entry><literallayout>achieve_type=1时为神将进阶到+5以上, achieve_data=Array(nick_name, fellow_id, advanced_level); 
achieve_type=2时为情缘抽到紫将, achieve_data=Array(nick_name, card_type, Array(fellow_id, ...)); 
    注 card_type: uint, 1-凡缘,2-良缘,3-奇缘,4-奇缘十连抽。
achieve_type=3时为竞技场前十名, achieve_data=Array(nick_name, rank); 
    注 rank: uint, 为在竞技场中的名次。
achieve_type=4时为开箱子得到稀有道具, achieve_data=Array(nick_name, chest_id, Array((item_type, item_id, quantity), ...)); 
    注 chest_id: uint, 宝箱ID。item_id: uint, 道具ID。
achieve_type=5时为翻牌得到稀有道具, achieve_data=Array(nick_name, item_type, item_id, quantity)
achieve_type=6时为限时神将抽到紫将, achieve_data=Array(nick_name, fellow_id); 
achieve_type=7时为新年红包抽到钻石, achieve_data=Array(nick_name, credits); 
achieve_type=8时为情人之吻抽到豪华礼包, achieve_data=Array(nick_name, Array(item_user_id, item_type, item_id, item_num));
achieve_type=9时为充值 achieve_data = Array(nick_name, lead_id, charge_id, vip_level) charge_id:充值档
achieve_type=10时为vip升级 achieve_data = Array(nick_name, lead_id, vip_level) 
achieve_type=11时为魔主第一名 achieve_data = Array(nick_name, lead_id)
achieve_type=12时为十连抽 achieve_data = Array(nick_name, lead_id)
                        </literallayout></entry>
                      </row>
                    </tbody>
                    </tgroup>
                </informaltable></entry>
                <entry></entry>
                </row>
                <row>
                    <entry>协议说明</entry><entry namest="2" nameend="5"></entry>
                </row>
            </tbody>
            </tgroup>
        </informaltable></para>
    </section>

	<section>
		<title>多播推送状态有更新的事件</title>
		<para>
			<informaltable>
				<tgroup cols="5">
					<colspec colnum="1" colname="1"/>
					<colspec colnum="2" colname="2"/>
					<colspec colnum="3" colname="3"/>
					<colspec colnum="4" colname="4"/>
					<colspec colnum="5" colname="5"/>
					<tbody>
						<row>
							<entry>协议名称</entry>
							<entry namest="2" nameend="5">向部分玩家推送状态有更新的事件</entry>
						</row>
						<row>
							<entry>呼叫方</entry>
							<entry>应答方</entry>
							<entry>函数名</entry>
							<entry>请求参数说明</entry>
							<entry>返回值格式说明</entry>
						</row>
						<row>
							<entry>网关服务器</entry>
							<entry>客户端</entry>
							<entry>sync_multicast</entry>
							<entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
                                            <row>
                                                <entry>event_id</entry>
                                                <entry>uint</entry>
                                                <entry>状态有更新的事件ID。1:领奖中心; 2:精彩活动; 4:玩家的仙盟权限变更; 5:玩家被踢出/主动离开仙盟; 6:仙盟的公共信息有变更; 7:玩家加入仙盟; 8:精彩活动公告有更新 9:累计充值奖励有更新 10：累计消费奖励有更新 </entry>
                                            </row>
                                            <row>
                                                <entry>event_args</entry>
                                                <entry>Array</entry>
                                                <entry><literallayout>状态有更新的事件详情, 不同event_id有不同的参数。
注：
当event_id=1,2,5,7,8,9,10时, event_args=[], 即无参数。
当event_id=4 时, event_args=[alliance_id, position]。推送给某个在线玩家。
当event_id=6 时, event_args=[alliance_id, alliance_level, alliance_exp], 其中alliance_id-仙盟ID,用于客户端校验, alliance_level-仙盟的等级, alliance_exp-仙盟当前建设值。
</literallayout></entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
							</entry>
							<entry></entry>
						</row>
						<row>
							<entry>协议说明</entry>
							<entry namest="2" nameend="5"/>
						</row>
					</tbody>
				</tgroup>
			</informaltable>
		</para>
	</section>

	<section>
		<title>推送有新的聊天信息的通知</title>
		<para>
			<informaltable>
				<tgroup cols="5">
					<colspec colnum="1" colname="1"/>
					<colspec colnum="2" colname="2"/>
					<colspec colnum="3" colname="3"/>
					<colspec colnum="4" colname="4"/>
					<colspec colnum="5" colname="5"/>
					<tbody>
						<row>
							<entry>协议名称</entry>
							<entry namest="2" nameend="5">向在线玩家推送有新的聊天信息的通知, 已通知过的不再通知</entry>
						</row>
						<row>
							<entry>呼叫方</entry>
							<entry>应答方</entry>
							<entry>函数名</entry>
							<entry>请求参数说明</entry>
							<entry>返回值格式说明</entry>
						</row>
						<row>
							<entry>消息服务器</entry>
							<entry>客户端</entry>
							<entry>new_chat_message</entry>
							<entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
                                            <row>
                                                <entry>room_type</entry>
                                                <entry>uint</entry>
                                                <entry>有新消息的房间类型。1:公聊; 2:私聊; 3:仙盟聊天</entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
							</entry>
							<entry></entry>
						</row>
						<row>
							<entry>协议说明</entry>
							<entry namest="2" nameend="5"/>
						</row>
					</tbody>
				</tgroup>
			</informaltable>
		</para>
	</section>

	<section>
		<title>玩家进入房间</title>
		<para>
			<informaltable>
				<tgroup cols="5">
					<colspec colnum="1" colname="1"/>
					<colspec colnum="2" colname="2"/>
					<colspec colnum="3" colname="3"/>
					<colspec colnum="4" colname="4"/>
					<colspec colnum="5" colname="5"/>
					<tbody>
						<row>
							<entry>协议名称</entry>
							<entry namest="2" nameend="5">玩家进入房间, 获取最近20条聊天消息</entry>
						</row>
						<row>
							<entry>呼叫方</entry>
							<entry>应答方</entry>
							<entry>函数名</entry>
							<entry>请求参数说明</entry>
							<entry>返回值格式说明</entry>
						</row>
						<row>
							<entry>客户端</entry>
							<entry>消息服务器</entry>
							<entry>chat_room_join</entry>
							<entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
                                            <row>
                                                <entry>room_type</entry>
                                                <entry>uint</entry>
                                                <entry>聊天类型。1-公聊; 2-私聊; 3-仙盟聊天</entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
							</entry>
                            <entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
											<row>
												<entry>result</entry>
												<entry>uint</entry>
												<entry>状态。0：获取成功。其它见<link linkend="errorlist">错误代码列表</link>.</entry>
											</row>
                                            <row>
                                                <entry>messages</entry>
                                                <entry>Array(msg, ...)</entry>
                                                <entry>消息列表。其中msg=[msg_id, sender_cid, lead_id, nick_name, vip_level, content, level, might, position]</entry>
                                            </row>
                                            <row>
                                                <entry>msg_id</entry>
                                                <entry>uint</entry>
                                                <entry>标识一条消息的唯一ID</entry>
                                            </row>
                                            <row>
                                                <entry>sender_cid</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的CID</entry>
                                            </row>
                                            <row>
                                                <entry>lead_id</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的角色ID</entry>
                                            </row>
                                            <row>
                                                <entry>nick_name</entry>
                                                <entry>string</entry>
                                                <entry>消息发送者的昵称</entry>
                                            </row>
                                            <row>
                                                <entry>vip_level</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的VIP等级</entry>
                                            </row>
                                            <row>
                                                <entry>content</entry>
                                                <entry>string</entry>
                                                <entry>内容</entry>
                                            </row>
                                            <row>
                                                <entry>level</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的等级</entry>
                                            </row>
                                            <row>
                                                <entry>might</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的战力</entry>
                                            </row>
                                            <row>
                                                <entry>position</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者在仙盟中的职位。0-无仙盟; 1-盟主; 2:副盟主; 3:成员</entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
                            </entry>
						</row>
						<row>
							<entry>协议说明</entry>
							<entry namest="2" nameend="5"/>
						</row>
					</tbody>
				</tgroup>
			</informaltable>
		</para>
	</section>

	<section>
		<title>玩家在房间中 获取历史聊天记录</title>
		<para>
			<informaltable>
				<tgroup cols="5">
					<colspec colnum="1" colname="1"/>
					<colspec colnum="2" colname="2"/>
					<colspec colnum="3" colname="3"/>
					<colspec colnum="4" colname="4"/>
					<colspec colnum="5" colname="5"/>
					<tbody>
						<row>
							<entry>协议名称</entry>
							<entry namest="2" nameend="5">玩家在房间中, 获取聊天记录, 50条聊天消息</entry>
						</row>
						<row>
							<entry>呼叫方</entry>
							<entry>应答方</entry>
							<entry>函数名</entry>
							<entry>请求参数说明</entry>
							<entry>返回值格式说明</entry>
						</row>
						<row>
							<entry>客户端</entry>
							<entry>消息服务器</entry>
							<entry>chat_room_history</entry>
							<entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
                                            <row>
                                                <entry>room_type</entry>
                                                <entry>uint</entry>
                                                <entry>聊天类型。1-公聊; 2-私聊; 3-仙盟聊天</entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
							</entry>
                            <entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
											<row>
												<entry>result</entry>
												<entry>uint</entry>
												<entry>状态。0：获取成功。其它见<link linkend="errorlist">错误代码列表</link>.</entry>
											</row>
                                            <row>
                                                <entry>messages</entry>
                                                <entry>Array(msg, ...)</entry>
                                                <entry>消息列表。其中msg=[msg_id, sender_cid, lead_id, nick_name, vip_level, content, level, might, position]</entry>
                                            </row>
                                            <row>
                                                <entry>msg_id</entry>
                                                <entry>uint</entry>
                                                <entry>标识一条消息的唯一ID</entry>
                                            </row>
                                            <row>
                                                <entry>sender_cid</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的CID</entry>
                                            </row>
                                            <row>
                                                <entry>lead_id</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的角色ID</entry>
                                            </row>
                                            <row>
                                                <entry>nick_name</entry>
                                                <entry>string</entry>
                                                <entry>消息发送者的昵称</entry>
                                            </row>
                                            <row>
                                                <entry>vip_level</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的VIP等级</entry>
                                            </row>
                                            <row>
                                                <entry>content</entry>
                                                <entry>string</entry>
                                                <entry>内容</entry>
                                            </row>
                                            <row>
                                                <entry>level</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的等级</entry>
                                            </row>
                                            <row>
                                                <entry>might</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的战力</entry>
                                            </row>
                                            <row>
                                                <entry>position</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者在仙盟中的职位。0-无仙盟; 1-盟主; 2:副盟主; 3:成员</entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
                            </entry>
						</row>
						<row>
							<entry>协议说明</entry>
							<entry namest="2" nameend="5"/>
						</row>
					</tbody>
				</tgroup>
			</informaltable>
		</para>
	</section>

	<section>
		<title>玩家退出房间</title>
		<para>
			<informaltable>
				<tgroup cols="5">
					<colspec colnum="1" colname="1"/>
					<colspec colnum="2" colname="2"/>
					<colspec colnum="3" colname="3"/>
					<colspec colnum="4" colname="4"/>
					<colspec colnum="5" colname="5"/>
					<tbody>
						<row>
							<entry>协议名称</entry>
							<entry namest="2" nameend="5">玩家退出房间请求</entry>
						</row>
						<row>
							<entry>呼叫方</entry>
							<entry>应答方</entry>
							<entry>函数名</entry>
							<entry>请求参数说明</entry>
							<entry>返回值格式说明</entry>
						</row>
						<row>
							<entry>客户端</entry>
							<entry>消息服务器</entry>
							<entry>chat_room_leave</entry>
							<entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
										</tbody>
									</tgroup>
								</informaltable>
							</entry>
                            <entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
											<row>
												<entry>result</entry>
												<entry>uint</entry>
												<entry>状态。0：获取成功。其它见<link linkend="errorlist">错误代码列表</link>.</entry>
											</row>
										</tbody>
									</tgroup>
								</informaltable>
                            </entry>
						</row>
						<row>
							<entry>协议说明</entry>
							<entry namest="2" nameend="5"/>
						</row>
					</tbody>
				</tgroup>
			</informaltable>
		</para>
	</section>

	<section>
		<title>给房间推送的世界聊天信息</title>
		<para>
			<informaltable>
				<tgroup cols="5">
					<colspec colnum="1" colname="1"/>
					<colspec colnum="2" colname="2"/>
					<colspec colnum="3" colname="3"/>
					<colspec colnum="4" colname="4"/>
					<colspec colnum="5" colname="5"/>
					<tbody>
						<row>
							<entry>协议名称</entry>
							<entry namest="2" nameend="5">定期推送的房间聊天信息, 每隔5s广播最多50条信息</entry>
						</row>
						<row>
							<entry>呼叫方</entry>
							<entry>应答方</entry>
							<entry>函数名</entry>
							<entry>请求参数说明</entry>
							<entry>返回值格式说明</entry>
						</row>
						<row>
							<entry>消息服务器</entry>
							<entry>客户端</entry>
							<entry>channel_broadcast</entry>
							<entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
                                            <row>
                                                <entry>messages</entry>
                                                <entry>Array(msg, ...)</entry>
                                                <entry>消息列表。其中msg=[msg_id, sender_cid, lead_id, nick_name, vip_level, content, level, might, position]</entry>
                                            </row>
                                            <row>
                                                <entry>msg_id</entry>
                                                <entry>uint</entry>
                                                <entry>标识一条消息的唯一ID</entry>
                                            </row>
                                            <row>
                                                <entry>sender_cid</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的CID</entry>
                                            </row>
                                            <row>
                                                <entry>lead_id</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的角色ID</entry>
                                            </row>
                                            <row>
                                                <entry>nick_name</entry>
                                                <entry>string</entry>
                                                <entry>消息发送者的昵称</entry>
                                            </row>
                                            <row>
                                                <entry>vip_level</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的VIP等级</entry>
                                            </row>
                                            <row>
                                                <entry>content</entry>
                                                <entry>string</entry>
                                                <entry>内容</entry>
                                            </row>
                                            <row>
                                                <entry>level</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的等级</entry>
                                            </row>
                                            <row>
                                                <entry>might</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的战力</entry>
                                            </row>
                                            <row>
                                                <entry>position</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者在仙盟中的职位。0-无仙盟; 1-盟主; 2:副盟主; 3:成员</entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
							</entry>
							<entry></entry>
						</row>
						<row>
							<entry>协议说明</entry>
							<entry namest="2" nameend="5"/>
						</row>
					</tbody>
				</tgroup>
			</informaltable>
		</para>
	</section>

	<section>
		<title>实时推送的私聊信息</title>
		<para>
			<informaltable>
				<tgroup cols="5">
					<colspec colnum="1" colname="1"/>
					<colspec colnum="2" colname="2"/>
					<colspec colnum="3" colname="3"/>
					<colspec colnum="4" colname="4"/>
					<colspec colnum="5" colname="5"/>
					<tbody>
						<row>
							<entry>协议名称</entry>
							<entry namest="2" nameend="5">实时推送的私聊信息</entry>
						</row>
						<row>
							<entry>呼叫方</entry>
							<entry>应答方</entry>
							<entry>函数名</entry>
							<entry>请求参数说明</entry>
							<entry>返回值格式说明</entry>
						</row>
						<row>
							<entry>消息服务器</entry>
							<entry>客户端</entry>
							<entry>private_forward_to</entry>
							<entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
                                            <row>
                                                <entry>msg</entry>
                                                <entry>Array(msg_id, sender_cid, lead_id, nick_name, vip_level, content, level, might, position)</entry>
                                                <entry>发送的私聊信息。</entry>
                                            </row>
                                            <row>
                                                <entry>msg_id</entry>
                                                <entry>uint</entry>
                                                <entry>标识一条消息的唯一ID</entry>
                                            </row>
                                            <row>
                                                <entry>sender_cid</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的CID</entry>
                                            </row>
                                            <row>
                                                <entry>lead_id</entry>
                                                <entry>uint</entry>
                                                <entry>发送者的角色ID</entry>
                                            </row>
                                            <row>
                                                <entry>nick_name</entry>
                                                <entry>string</entry>
                                                <entry>发送者的昵称</entry>
                                            </row>
                                            <row>
                                                <entry>vip_level</entry>
                                                <entry>uint</entry>
                                                <entry>发送者的VIP等级</entry>
                                            </row>
                                            <row>
                                                <entry>content</entry>
                                                <entry>string</entry>
                                                <entry>内容</entry>
                                            </row>
                                            <row>
                                                <entry>level</entry>
                                                <entry>uint</entry>
                                                <entry>发送者的等级</entry>
                                            </row>
                                            <row>
                                                <entry>might</entry>
                                                <entry>uint</entry>
                                                <entry>发送者的战力</entry>
                                            </row>
                                            <row>
                                                <entry>position</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者在仙盟中的职位。0-无仙盟; 1-盟主; 2:副盟主; 3:成员</entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
							</entry>
							<entry></entry>
						</row>
						<row>
							<entry>协议说明</entry>
							<entry namest="2" nameend="5"/>
						</row>
					</tbody>
				</tgroup>
			</informaltable>
		</para>
	</section>

    <section>
        <title>给房间推送的仙盟聊天信息</title>
        <para>
        	<informaltable>
        		<tgroup cols="5">
        			<colspec colnum="1" colname="1"/>
        			<colspec colnum="2" colname="2"/>
        			<colspec colnum="3" colname="3"/>
        			<colspec colnum="4" colname="4"/>
        			<colspec colnum="5" colname="5"/>
        			<tbody>
        				<row>
        					<entry>协议名称</entry>
        					<entry namest="2" nameend="5">定期推送的仙盟聊天信息, 每隔5s广播最多50条信息</entry>
        				</row>
        				<row>
        					<entry>呼叫方</entry>
        					<entry>应答方</entry>
        					<entry>函数名</entry>
        					<entry>请求参数说明</entry>
        					<entry>返回值格式说明</entry>
        				</row>
        				<row>
        					<entry>消息服务器</entry>
        					<entry>客户端</entry>
        					<entry>alliance_broadcast</entry>
        					<entry>
        						<informaltable>
        							<tgroup cols="3">
        								<colspec colnum="1" colname="1"/>
        								<colspec colnum="2" colname="2"/>
        								<colspec colnum="3" colname="3"/>
        								<tbody>
        									<row>
        										<entry>参数</entry>
        										<entry>类型</entry>
        										<entry>说明</entry>
        									</row>
                                            <row>
                                                <entry>messages</entry>
                                                <entry>Array(msg, ...)</entry>
                                                <entry>消息列表。其中msg=[msg_id, sender_cid, lead_id, nick_name, vip_level, content, level, might, position]</entry>
                                            </row>
                                            <row>
                                                <entry>msg_id</entry>
                                                <entry>uint</entry>
                                                <entry>标识一条消息的唯一ID</entry>
                                            </row>
                                            <row>
                                                <entry>sender_cid</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的CID</entry>
                                            </row>
                                            <row>
                                                <entry>lead_id</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的角色ID</entry>
                                            </row>
                                            <row>
                                                <entry>nick_name</entry>
                                                <entry>string</entry>
                                                <entry>消息发送者的昵称</entry>
                                            </row>
                                            <row>
                                                <entry>vip_level</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的VIP等级</entry>
                                            </row>
                                            <row>
                                                <entry>content</entry>
                                                <entry>string</entry>
                                                <entry>内容</entry>
                                            </row>
                                            <row>
                                                <entry>level</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的等级</entry>
                                            </row>
                                            <row>
                                                <entry>might</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者的战力</entry>
                                            </row>
                                            <row>
                                                <entry>position</entry>
                                                <entry>uint</entry>
                                                <entry>消息发送者在仙盟中的职位。0-无仙盟; 1-盟主; 2:副盟主; 3:成员</entry>
                                            </row>
        								</tbody>
        							</tgroup>
        						</informaltable>
        					</entry>
        					<entry></entry>
        				</row>
        				<row>
        					<entry>协议说明</entry>
        					<entry namest="2" nameend="5"/>
        				</row>
        			</tbody>
        		</tgroup>
        	</informaltable>
        </para>
    </section>

    <section>
        <title>世界聊天</title>
        <para>
        	<informaltable>
        		<tgroup cols="5">
        			<colspec colnum="1" colname="1"/>
        			<colspec colnum="2" colname="2"/>
        			<colspec colnum="3" colname="3"/>
        			<colspec colnum="4" colname="4"/>
        			<colspec colnum="5" colname="5"/>
        			<tbody>
        				<row>
        					<entry>协议名称</entry>
        					<entry namest="2" nameend="5">在世界聊天中发送聊天内容</entry>
        				</row>
        				<row>
        					<entry>呼叫方</entry>
        					<entry>应答方</entry>
        					<entry>函数名</entry>
        					<entry>请求参数说明</entry>
        					<entry>返回值格式说明</entry>
        				</row>
        				<row>
        					<entry>客户端</entry>
        					<entry>消息服务器</entry>
        					<entry>chat_channel</entry>
        					<entry>
        						<informaltable>
        							<tgroup cols="3">
        								<colspec colnum="1" colname="1"/>
        								<colspec colnum="2" colname="2"/>
        								<colspec colnum="3" colname="3"/>
        								<tbody>
        									<row>
        										<entry>参数</entry>
        										<entry>类型</entry>
        										<entry>说明</entry>
        									</row>
                                            <row>
                                                <entry>content</entry>
                                                <entry>string</entry>
                                                <entry>要发送的聊天内容</entry>
                                            </row>
        								</tbody>
        							</tgroup>
        						</informaltable>
        					</entry>
                            <entry>
        						<informaltable>
        							<tgroup cols="3">
        								<colspec colnum="1" colname="1"/>
        								<colspec colnum="2" colname="2"/>
        								<colspec colnum="3" colname="3"/>
        								<tbody>
        									<row>
        										<entry>参数</entry>
        										<entry>类型</entry>
        										<entry>说明</entry>
        									</row>
        									<row>
        										<entry>result</entry>
        										<entry>uint</entry>
        										<entry>状态。0：获取成功。其它见<link linkend="errorlist">错误代码列表</link>.</entry>
        									</row>
                                            <row>
                                                <entry>msg_id</entry>
                                                <entry>uint</entry>
                                                <entry>标识一条消息的唯一ID</entry>
                                            </row>
        								</tbody>
        							</tgroup>
        						</informaltable>
                            </entry>
        				</row>
        				<row>
        					<entry>协议说明</entry>
        					<entry namest="2" nameend="5"/>
        				</row>
        			</tbody>
        		</tgroup>
        	</informaltable>
        </para>
    </section>

	<section>
		<title>私聊</title>
		<para>
			<informaltable>
				<tgroup cols="5">
					<colspec colnum="1" colname="1"/>
					<colspec colnum="2" colname="2"/>
					<colspec colnum="3" colname="3"/>
					<colspec colnum="4" colname="4"/>
					<colspec colnum="5" colname="5"/>
					<tbody>
						<row>
							<entry>协议名称</entry>
							<entry namest="2" nameend="5">在私聊中发送聊天内容</entry>
						</row>
						<row>
							<entry>呼叫方</entry>
							<entry>应答方</entry>
							<entry>函数名</entry>
							<entry>请求参数说明</entry>
							<entry>返回值格式说明</entry>
						</row>
						<row>
							<entry>客户端</entry>
							<entry>消息服务器</entry>
							<entry>chat_private</entry>
							<entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
                                            <row>
                                                <entry>receiver_nick_name</entry>
                                                <entry>string</entry>
                                                <entry>接收者的昵称</entry>
                                            </row>
                                            <row>
                                                <entry>content</entry>
                                                <entry>string</entry>
                                                <entry>要发送的聊天内容</entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
							</entry>
                            <entry>
								<informaltable>
									<tgroup cols="3">
										<colspec colnum="1" colname="1"/>
										<colspec colnum="2" colname="2"/>
										<colspec colnum="3" colname="3"/>
										<tbody>
											<row>
												<entry>参数</entry>
												<entry>类型</entry>
												<entry>说明</entry>
											</row>
											<row>
												<entry>result</entry>
												<entry>uint</entry>
												<entry>状态。0：获取成功。其它见<link linkend="errorlist">错误代码列表</link>.</entry>
											</row>
                                            <row>
                                                <entry>msg_id</entry>
                                                <entry>uint</entry>
                                                <entry>标识一条消息的唯一ID</entry>
                                            </row>
										</tbody>
									</tgroup>
								</informaltable>
                            </entry>
						</row>
						<row>
							<entry>协议说明</entry>
							<entry namest="2" nameend="5"/>
						</row>
					</tbody>
				</tgroup>
			</informaltable>
		</para>
	</section>

    <section>
        <title>仙盟聊天</title>
        <para>
        	<informaltable>
        		<tgroup cols="5">
        			<colspec colnum="1" colname="1"/>
        			<colspec colnum="2" colname="2"/>
        			<colspec colnum="3" colname="3"/>
        			<colspec colnum="4" colname="4"/>
        			<colspec colnum="5" colname="5"/>
        			<tbody>
        				<row>
        					<entry>协议名称</entry>
        					<entry namest="2" nameend="5">在仙盟聊天中发送聊天内容</entry>
        				</row>
        				<row>
        					<entry>呼叫方</entry>
        					<entry>应答方</entry>
        					<entry>函数名</entry>
        					<entry>请求参数说明</entry>
        					<entry>返回值格式说明</entry>
        				</row>
        				<row>
        					<entry>客户端</entry>
        					<entry>消息服务器</entry>
        					<entry>chat_alliance</entry>
        					<entry>
        						<informaltable>
        							<tgroup cols="3">
        								<colspec colnum="1" colname="1"/>
        								<colspec colnum="2" colname="2"/>
        								<colspec colnum="3" colname="3"/>
        								<tbody>
        									<row>
        										<entry>参数</entry>
        										<entry>类型</entry>
        										<entry>说明</entry>
        									</row>
                                            <row>
                                                <entry>content</entry>
                                                <entry>string</entry>
                                                <entry>要发送的聊天内容</entry>
                                            </row>
        								</tbody>
        							</tgroup>
        						</informaltable>
        					</entry>
                            <entry>
        						<informaltable>
        							<tgroup cols="3">
        								<colspec colnum="1" colname="1"/>
        								<colspec colnum="2" colname="2"/>
        								<colspec colnum="3" colname="3"/>
        								<tbody>
        									<row>
        										<entry>参数</entry>
        										<entry>类型</entry>
        										<entry>说明</entry>
        									</row>
        									<row>
        										<entry>result</entry>
        										<entry>uint</entry>
        										<entry>状态。0：获取成功。其它见<link linkend="errorlist">错误代码列表</link>.</entry>
        									</row>
                                            <row>
                                                <entry>msg_id</entry>
                                                <entry>uint</entry>
                                                <entry>标识一条消息的唯一ID</entry>
                                            </row>
        								</tbody>
        							</tgroup>
        						</informaltable>
                            </entry>
        				</row>
        				<row>
        					<entry>协议说明</entry>
        					<entry namest="2" nameend="5"/>
        				</row>
        			</tbody>
        		</tgroup>
        	</informaltable>
        </para>
    </section>

    <section>
        <title>获取本地循环播放的走马灯消息</title>
        <para><informaltable>
            <tgroup cols="5">
            <colspec colnum="1" colname="1" />
            <colspec colnum="2" colname="2" />
            <colspec colnum="3" colname="3" />
            <colspec colnum="4" colname="4" />
            <colspec colnum="5" colname="5" />
            <tbody>
                <row>
                    <entry>协议名称</entry><entry namest="2" nameend="5">获取本地循环播放的走马灯消息</entry>
                </row>
                <row>
                    <entry>呼叫方</entry>
                    <entry>应答方</entry>
                    <entry>函数名</entry>
                    <entry>请求参数说明</entry>
                    <entry>返回值格式说明</entry>
                </row>
                <row>
                    <entry>网关服务器</entry>
                    <entry>客户端</entry>
                    <entry>get_broadcast_messages</entry>
                    <entry><informaltable>
                    <tgroup cols="3">
                    <colspec colname="1" colnum="1"/>
                    <colspec colname="2" colnum="2"/>
                    <colspec colname="3" colnum="3"/>
                    <tbody>
                      <row>
                        <entry>参数</entry>
                        <entry>类型</entry>
                        <entry>说明</entry>
                      </row>
                      <row>
                        <entry>messages</entry>
                        <entry>Array(msg, ...)</entry>
                        <entry>本地循环播放的走马灯消息列表。</entry>
                      </row>
                      <row>
                        <entry>msg</entry>
                        <entry>String</entry>
                        <entry>走马灯的内容。</entry>
                      </row>
                    </tbody>
                    </tgroup>
                </informaltable></entry>
                <entry></entry>
                </row>
                <row>
                    <entry>协议说明</entry><entry namest="2" nameend="5"></entry>
                </row>
            </tbody>
            </tgroup>
        </informaltable></para>
    </section>

    <section>
        <title>全服推送新跑马灯的同步消息</title>
        <para><informaltable>
            <tgroup cols="5">
            <colspec colnum="1" colname="1" />
            <colspec colnum="2" colname="2" />
            <colspec colnum="3" colname="3" />
            <colspec colnum="4" colname="4" />
            <colspec colnum="5" colname="5" />
            <tbody>
                <row>
                    <entry>协议名称</entry><entry namest="2" nameend="5">全服推送新跑马灯的同步消息</entry>
                </row>
                <row>
                    <entry>呼叫方</entry>
                    <entry>应答方</entry>
                    <entry>函数名</entry>
                    <entry>请求参数说明</entry>
                    <entry>返回值格式说明</entry>
                </row>
                <row>
                    <entry>网关服务器</entry>
                    <entry>客户端</entry>
                    <entry>new_sync_broadcast</entry>
                    <entry></entry>
                    <entry><informaltable>
                    <tgroup cols="3">
                    <colspec colname="1" colnum="1"/>
                    <colspec colname="2" colnum="2"/>
                    <colspec colname="3" colnum="3"/>
                    <tbody>
                      <row>
                        <entry>参数</entry>
                        <entry>类型</entry>
                        <entry>说明</entry>
                      </row>
                      <row>
                        <entry>messages</entry>
                        <entry>Array(Array(msg_id, msg_type, user_name, user_quality, value), ...)</entry>
                        <entry>本次推送的走马灯消息列表，可能多条。</entry>
                      </row>
                      <row>
                        <entry>msg_id</entry>
                        <entry>int</entry>
                        <entry>唯一id,用于领取,如果没有红包则为0</entry>
                      </row>
                      <row>
                        <entry>msg_type</entry>
                        <entry>int</entry>
                        <entry>1-充值，2-vip升级，3-魔主第一名，4-十连抽</entry>
                      </row>
                      <row>
                        <entry>user_name</entry>
                        <entry>string</entry>
                        <entry>玩家名字</entry>
                      </row>
                      <row>
                        <entry>user_quality</entry>
                        <entry>int</entry>
                        <entry>玩家品质</entry>
                      </row>
                      <row>
                        <entry>value</entry>
                        <entry>int</entry>
                        <entry>type为1，则为充值数，type为2，则为vip等级，其他则为0</entry>
                      </row>
                    </tbody>
                    </tgroup>
                </informaltable></entry>
                <entry></entry>
                </row>
                <row>
                    <entry>协议说明</entry><entry namest="2" nameend="5"></entry>
                </row>
            </tbody>
            </tgroup>
        </informaltable></para>
    </section>
    <section>
        <title>领取跑马灯奖励</title>
        <para>
            <informaltable>
                <tgroup cols="5">
        			<colspec colnum="1" colname="1"/>
        			<colspec colnum="2" colname="2"/>
        			<colspec colnum="3" colname="3"/>
        			<colspec colnum="4" colname="4"/>
        			<colspec colnum="5" colname="5"/>
        			<tbody>
        				<row>
        					<entry>协议名称</entry>
        					<entry namest="2" nameend="5">领取跑马灯奖励</entry>
        				</row>
        				<row>
        					<entry>呼叫方</entry>
        					<entry>应答方</entry>
        					<entry>函数名</entry>
        					<entry>请求参数说明</entry>
        					<entry>返回值格式说明</entry>
        				</row>
        				<row>
        					<entry>客户端</entry>
        					<entry>网关服务器</entry>
        					<entry>get_broad_reward</entry>
        					<entry>
        						<informaltable>
        							<tgroup cols="3">
        								<colspec colnum="1" colname="1"/>
        								<colspec colnum="2" colname="2"/>
        								<colspec colnum="3" colname="3"/>
        								<tbody>
        									<row>
        										<entry>参数</entry>
        										<entry>类型</entry>
        										<entry>说明</entry>
        									</row>
        									<row>
        										<entry>id</entry>
        										<entry>uint</entry>
        										<entry>唯一id</entry>
        									</row>
        									<row>
        										<entry>quest_type</entry>
        										<entry>uint</entry>
        										<entry>msgtype。</entry>
        									</row>
        								</tbody>
        							</tgroup>
        						</informaltable>
        					</entry>
        					<entry>
        						<informaltable>
        							<tgroup cols="3">
        								<colspec colnum="1" colname="1"/>
        								<colspec colnum="2" colname="2"/>
        								<colspec colnum="3" colname="3"/>
        								<tbody>
        									<row>
        										<entry>参数</entry>
        										<entry>类型</entry>
        										<entry>说明</entry>
        									</row>
        									<row>
        										<entry>result</entry>
        										<entry>uint</entry>
        										<entry>状态。0：获取成功。其它见<link linkend="errorlist">错误代码列表</link>.</entry>
        									</row>
        									<row>
        										<entry>data</entry>
        										<entry>Array( Array(user_item_id, item_type, item_id, item_num), ... )</entry>
        										<entry>奖励</entry>
        									</row>
        									<row>
        										<entry>user_item_id</entry>
        										<entry>uint</entry>
        										<entry>玩家道具ID。item_type=1时user_item_id为0。</entry>
        									</row>
        									<row>
        										<entry>item_type</entry>
        										<entry>uint</entry>
        										<entry>奖励的道具类型, 含金币、仙魂</entry>
        									</row>
        									<row>
        										<entry>item_id</entry>
        										<entry>uint</entry>
        										<entry>奖励的道具ID</entry>
        									</row>
        									<row>
        										<entry>item_num</entry>
        										<entry>uint</entry>
        										<entry>奖励的道具数量</entry>
        									</row>
        								</tbody>
        							</tgroup>
        						</informaltable>
        					</entry>
        				</row>
        				<row>
        					<entry>协议说明</entry>
        					<entry namest="2" nameend="5"/>
        				</row>
        			</tbody>
        		</tgroup>
        	</informaltable>
        </para>
    </section>
</chapter>
